# fkAnonAi

fkAnonAi - это консольное приложение на C#, которое объединяет распознавание речи, анализ экрана и генерацию текста с использованием API Google Gemini, а также синтез речи для интерактивного взаимодействия.

## Особенности

*   **Распознавание речи:** Записывает аудио с микрофона и отправляет в Google Gemini для анализа.
*   **Анализ экрана:** Периодически захватывает скриншоты и отправляет их в Google Gemini для анализа и генерации описания.
*   **Генерация текста:** Использует модель Google Gemini (gemini-1.5-flash) для генерации ответов в стиле, указанном в `prompt.txt` (по умолчанию установлен промпт GLaDOS), основываясь на полученной речи и содержимом экрана.
*   **Синтез речи:** Использует sherpa-onnx для преобразования текста в речь и воспроизведения аудио.
*   **Персонализация:**
    *   Позволяет настраивать системный промпт через файл `prompt.txt`. Если файл отсутствует или пуст, используется стандартный промпт GLaDOS.
    *   Поддержка использования пользовательских моделей синтеза голоса (TTS).
*   **Настройка прокси:** Поддержка использования прокси-серверов (HTTP и SOCKS5) для обхода ограничений сети, с аутентификацией и без.
*   **Настройка интервала анализа экрана:** Возможность изменения интервала времени (в секундах) для отправки скриншотов на анализ через консольную команду `interval <секунды>`.
*   **Динамическое изменение прокси:** Возможность смены прокси-сервера во время работы программы через консольную команду `proxy <адрес[:порт][:имя пользователя][:пароль]>`.
*   **Автоматическое отключение микрофона при включенном Caps Lock:** Предотвращает нежелательную запись звука.

## Использование

1.  Клонируйте репозиторий (если он у вас есть, или скачайте код).
2.  Скомпилируйте проект с помощью .NET SDK.
3.  Запустите исполняемый файл (`fkAnonAi.exe` или аналогичный).
    *   Либо скачайте последнюю пре-билд версию в releases и запустите `fkAnonAi.exe`.

## Параметры запуска

*   `-api <ключ>`: Устанавливает ваш API ключ Google Gemini. Если не указан, используется `default_key`. Получить свой API ключ можно по ссылке: [https://aistudio.google.com/apikey](https://aistudio.google.com/apikey).
*   `-proxy <адрес[:порт][:имя пользователя][:пароль]>`: Устанавливает параметры прокси-сервера.
    *   Поддерживаются форматы:
        *   `address:port`
        *   `address:port:username:password`
        *   `socks5://address:port`
        *   `socks5://address:port:username:password`

    Примеры:

    ```
    -proxy 127.0.0.1:31112
    -proxy 192.168.1.100:8080:myuser:mypassword
    -proxy socks5://127.0.0.1:1080
    -proxy socks5://127.0.0.1:1080:myuser:mypassword
    ```

## Настройка

*   **`prompt.txt`:** В папке с программой создайте файл `prompt.txt`, в который можно записать пользовательский промпт для настройки персонажа. Если файл отсутствует или пуст, используется стандартный промпт GLaDOS.
*   **`models/ru/`:** Содержит необходимые модели для TTS (текст в речь). Если вы хотите использовать свою модель, поместите ее в эту папку, а также измените пути на ваши в коде (необходимо редактировать код!).
    *   Готовые модели можно найти здесь: [https://github.com/k2-fsa/sherpa-onnx/releases/tag/tts-models](https://github.com/k2-fsa/sherpa-onnx/releases/tag/tts-models). Подробнее: [https://k2-fsa.github.io/sherpa/onnx/tts/piper.html](https://k2-fsa.github.io/sherpa/onnx/tts/piper.html)

## Консольные команды

*   `interval <секунды>`: Изменяет интервал (в секундах) между захватами экрана и отправкой их на анализ.
*   `proxy <адрес[:порт][:имя пользователя][:пароль]>`: Динамически изменяет настройки прокси-сервера во время работы программы. Формат аналогичен параметру запуска `-proxy`.
*   `exit`: Завершает работу программы.

## Зависимости

*   GenerativeAI.Net
*   NAudio
*   SherpaOnnx

## Требования

*   .NET SDK 7.0 или выше
*   Windows (для захвата экрана)
*   API ключ Google Gemini
*   Модель TTS в папке `models/ru/`.

## Замечания

*   Программа находится в стадии разработки и может содержать ошибки.
*   Экранный захват в настоящее время поддерживается только на Windows.
*   Рекомендуется использовать наушники при работе с программой, чтобы избежать эха.
*   Программа разрабатывалась для двух мониторов с разрешением 1920x1080. Для других разрешений необходимо изменить `screenWidth` и `screenHeight` в функции `CaptureScreen`.